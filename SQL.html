<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>SQL. DBI 0.5</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">DBI 0.5</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>


    <div class="container">
      <header>
        
      </header>
      
      <h1>SQL quoting</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><span class="functioncall"><a href='SQL.html'>SQL</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">)</span>

<span class="functioncall"><a href='SQL.html'>dbQuoteIdentifier</a></span><span class="keyword">(</span><span class="symbol">conn</span><span class="keyword">,</span> <span class="symbol">x</span><span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">)</span>

<span class="functioncall"><a href='SQL.html'>dbQuoteString</a></span><span class="keyword">(</span><span class="symbol">conn</span><span class="keyword">,</span> <span class="symbol">x</span><span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">)</span></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>x</dt>
      <dd>A character vector to label as being escaped SQL.</dd>
      <dt>conn</dt>
      <dd>A subclass of <code><a href='DBIConnection-class.html'>DBIConnection</a></code>, representing
an active connection to an DBMS.</dd>
      <dt>...</dt>
      <dd>Other arguments passed on to methods. Not otherwise used.</dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p><dl>
An object of class <code>SQL</code>.
</dl></p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>

      <p>This set of classes and generics make it possible to flexibly deal with SQL
escaping needs. By default, any user supplied input to a query should be
escaped using either <code>dbQuoteIdentifier</code> or <code>dbQuoteString</code>
depending on whether it refers to a table or variable name, or is a literal
string.
These functions return an object of the <code>SQL</code> class,
which tells DBI functions that a character string does not need to be escaped
anymore, to prevent double escaping.
The <code>SQL</code> class has associated the <code>SQL()</code> constructor function.</p>
  
    </div>

    <div class="Implementation notes">
      <h2>Implementation notes</h2>

      <p></p>
  
      <p>DBI provides default generics for SQL-92 compatible quoting. If the database
uses a different convention, you will need to provide your own methods.
Note that because of the way that S4 dispatch finds methods and because
SQL inherits from character, if you implement (e.g.) a method for
<code>dbQuoteString(MyConnection, character)</code>, you will also need to
implement <code>dbQuoteString(MyConnection, SQL)</code> - this should simply
return <code>x</code> unchanged.</p>
  
      <p>If you implement your own method, make sure to convert NA to NULL (unquoted).</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'><span class="comment"># Quoting ensures that arbitrary input is safe for use in a query</span>
<span class="symbol">name</span> <span class="assignement">&lt;-</span> <span class="string">"Robert'); DROP TABLE Students;--"</span>
<span class="functioncall"><a href='SQL.html'>dbQuoteString</a></span><span class="keyword">(</span><span class="functioncall"><a href='ANSI.html'>ANSI</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="symbol">name</span><span class="keyword">)</span></div>
<div class='output'>&lt;SQL&gt; &#39;Robert&#39;&#39;); DROP TABLE Students;--&#39;
</div>
<div class='input'><span class="functioncall"><a href='SQL.html'>dbQuoteIdentifier</a></span><span class="keyword">(</span><span class="functioncall"><a href='ANSI.html'>ANSI</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="symbol">name</span><span class="keyword">)</span></div>
<div class='output'>&lt;SQL&gt; &quot;Robert&#39;); DROP TABLE Students;--&quot;
</div>
<div class='input'>
<span class="comment"># NAs become NULL</span>
<span class="functioncall"><a href='SQL.html'>dbQuoteString</a></span><span class="keyword">(</span><span class="functioncall"><a href='ANSI.html'>ANSI</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="functioncall"><a href='http://www.rdocumentation.org/packages/base/topics/c'>c</a></span><span class="keyword">(</span><span class="string">"x"</span><span class="keyword">,</span> <span class="number">NA</span><span class="keyword">)</span><span class="keyword">)</span></div>
<div class='output'>&lt;SQL&gt; &#39;x&#39;
&lt;SQL&gt; NULL
</div>
<div class='input'>
<span class="comment"># SQL vectors are always passed through as is</span>
<span class="symbol">var_name</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='SQL.html'>SQL</a></span><span class="keyword">(</span><span class="string">"select"</span><span class="keyword">)</span>
<span class="symbol">var_name</span></div>
<div class='output'>&lt;SQL&gt; select
</div>
<div class='input'>
<span class="functioncall"><a href='SQL.html'>dbQuoteIdentifier</a></span><span class="keyword">(</span><span class="functioncall"><a href='ANSI.html'>ANSI</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="symbol">var_name</span><span class="keyword">)</span></div>
<div class='output'>&lt;SQL&gt; select
</div>
<div class='input'><span class="functioncall"><a href='SQL.html'>dbQuoteString</a></span><span class="keyword">(</span><span class="functioncall"><a href='ANSI.html'>ANSI</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="symbol">var_name</span><span class="keyword">)</span></div>
<div class='output'>&lt;SQL&gt; select
</div>
<div class='input'>
<span class="comment"># This mechanism is used to prevent double escaping</span>
<span class="functioncall"><a href='SQL.html'>dbQuoteString</a></span><span class="keyword">(</span><span class="functioncall"><a href='ANSI.html'>ANSI</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="functioncall"><a href='SQL.html'>dbQuoteString</a></span><span class="keyword">(</span><span class="functioncall"><a href='ANSI.html'>ANSI</a></span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span> <span class="symbol">name</span><span class="keyword">)</span><span class="keyword">)</span></div>
<div class='output'>&lt;SQL&gt; &#39;Robert&#39;&#39;); DROP TABLE Students;--&#39;
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>SQL</li><li>SQL-class</li><li>dbQuoteIdentifier</li><li>dbQuoteString</li>
    </ul>
    <ul>
      
    </ul> -->
      
    <h2>See also</h2>
      <p>Other DBIResult generics: <code><a href='DBIResult-class.html'>DBIResult-class</a></code>,
  <code><a href='dbBind.html'>dbBind</a></code>, <code><a href='dbClearResult.html'>dbClearResult</a></code>,
  <code><a href='dbColumnInfo.html'>dbColumnInfo</a></code>, <code><a href='dbFetch.html'>dbFetch</a></code>,
  <code><a href='dbGetInfo.html'>dbGetInfo</a></code>, <code><a href='dbGetRowCount.html'>dbGetRowCount</a></code>,
  <code><a href='dbGetRowsAffected.html'>dbGetRowsAffected</a></code>,
  <code><a href='dbGetStatement.html'>dbGetStatement</a></code>,
  <code><a href='dbHasCompleted.html'>dbHasCompleted</a></code>, <code><a href='dbIsValid.html'>dbIsValid</a></code></p>

      <p>Other DBIResult generics: <code><a href='DBIResult-class.html'>DBIResult-class</a></code>,
  <code><a href='dbBind.html'>dbBind</a></code>, <code><a href='dbClearResult.html'>dbClearResult</a></code>,
  <code><a href='dbColumnInfo.html'>dbColumnInfo</a></code>, <code><a href='dbFetch.html'>dbFetch</a></code>,
  <code><a href='dbGetInfo.html'>dbGetInfo</a></code>, <code><a href='dbGetRowCount.html'>dbGetRowCount</a></code>,
  <code><a href='dbGetRowsAffected.html'>dbGetRowsAffected</a></code>,
  <code><a href='dbGetStatement.html'>dbGetStatement</a></code>,
  <code><a href='dbHasCompleted.html'>dbHasCompleted</a></code>, <code><a href='dbIsValid.html'>dbIsValid</a></code></p>

    

    
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="https://getbootstrap.com/2.0.4/">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>